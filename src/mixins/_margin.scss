@mixin _margin-impl($properties, $shorthand, $range, $conv-fn) {
	$ampersand: get-dynamic-ampersand();

	#{$ampersand}-#{$shorthand}-s {
		@each $property in $properties {
			#{$property}: calc(-1 * var(--parent-var-spacing, 0));
		}
	}
	#{$ampersand}-#{$shorthand}-s\/2 {
		@each $property in $properties {
			#{$property}: calc(-1 * var(--parent-var-spacing, 0) / 2);
		}
	}
	#{$ampersand}-#{$shorthand}-s\/4 {
		@each $property in $properties {
			#{$property}: calc(-1 * var(--parent-var-spacing, 0) / 4);
		}
	}

	#{$ampersand}#{$shorthand}-s {
		@each $property in $properties {
			#{$property}: var(--parent-var-spacing, 0);
		}
	}
	#{$ampersand}#{$shorthand}-s\/2 {
		@each $property in $properties {
			#{$property}: calc(var(--parent-var-spacing, 0) / 2);
		}
	}
	#{$ampersand}#{$shorthand}-s\/4 {
		@each $property in $properties {
			#{$property}: calc(var(--parent-var-spacing, 0) / 4);
		}
	}

	@include generate-from-range($properties, $shorthand, $range, $conv-fn);
}

@mixin margin-from-range($range, $conv-fn) {
	@include _margin-impl((margin), "m", $range, $conv-fn);
	@include _margin-impl((margin-left, margin-right), "mx", $range, $conv-fn);
	@include _margin-impl((margin-left), "ml", $range, $conv-fn);
	@include _margin-impl((margin-right), "mr", $range, $conv-fn);
	@include _margin-impl((margin-top, margin-bottom), "my", $range, $conv-fn);
	@include _margin-impl((margin-top), "mt", $range, $conv-fn);
	@include _margin-impl((margin-bottom), "mb", $range, $conv-fn);
}
